# üéØ –û–¢–ß–ï–¢ –ü–û –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò –ö–ï–®–ò–†–û–í–ê–ù–ò–Ø

## üìÖ –î–∞—Ç–∞: 12.06.2025
## üéØ –¶–µ–ª—å: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## üîÑ –ü–õ–ê–ù –†–ê–ë–û–¢–´

### **–≠—Ç–∞–ø 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–∞–≥–∞**
- ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: `messages.X.cache_control: Extra inputs are not permitted`
- üéØ –†–µ—à–µ–Ω–∏–µ: –£–±—Ä–∞—Ç—å `cache_control` –∏–∑ messages, –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤ system prompt
- üìÅ –§–∞–π–ª—ã: `src/services/ClaudeService.js`

### **–≠—Ç–∞–ø 2: –£–º–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è**  
- üéØ –†–µ—à–µ–Ω–∏–µ: Sliding window - —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ system prompt
- üìÅ –§–∞–π–ª—ã: `src/services/ClaudeService.js`

---

## üìä –ù–ê–ß–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï

**–¢–µ–∫—É—â–∏–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö:**
```
{"error":"messages.4.cache_control: Extra inputs are not permitted"}
{"error":"messages.5.cache_control: Extra inputs are not permitted"}
```

**–¢–µ–∫—É—â–∏–π –∫–æ–º–º–∏—Ç:** `17c546d` - fix: implement proper Anthropic prompt caching strategy

**–ö–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è:**
```bash
git reset --hard 17c546d
```

---

## üîß –≠–¢–ê–ü 1: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ë–ê–ì–ê

### –ß—Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–æ:
1. –ù–∞–π—Ç–∏ –º–µ—Ç–æ–¥ –≥–¥–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è `cache_control` –∫ messages
2. –£–±—Ä–∞—Ç—å —ç—Ç—É –ª–æ–≥–∏–∫—É  
3. –û—Å—Ç–∞–≤–∏—Ç—å `cache_control` —Ç–æ–ª—å–∫–æ –¥–ª—è system prompt
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á—Ç–æ –æ—à–∏–±–∫–∏ –∏—Å—á–µ–∑–ª–∏

### –ö–æ–º–º–∏—Ç: `fix: remove cache_control from messages - only system allowed`

### –û—Ç–∫–∞—Ç —ç—Ç–∞–ø–∞ 1:
```bash
git reset --hard <COMMIT_HASH_–≠–¢–ê–ü–ê_1>
```

---

## üß† –≠–¢–ê–ü 2: –£–ú–ù–û–ï –ö–ï–®–ò–†–û–í–ê–ù–ò–ï

### –ß—Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–æ:
1. –õ–æ–≥–∏–∫–∞ –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –¥–∏–∞–ª–æ–≥–æ–≤ (‚â§10 —Å–æ–æ–±—â–µ–Ω–∏–π): –ø—Ä–æ—Å—Ç–æ–π system –∫–µ—à
2. –õ–æ–≥–∏–∫–∞ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ (>10 —Å–æ–æ–±—â–µ–Ω–∏–π): sliding window
3. –ü–µ—Ä–µ–Ω–æ—Å —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ system prompt –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

### –ö–æ–º–º–∏—Ç: `feat: implement sliding window cache strategy`

### –û—Ç–∫–∞—Ç —ç—Ç–∞–ø–∞ 2:
```bash
git reset --hard <COMMIT_HASH_–≠–¢–ê–ü–ê_2>
```

---

## üö® –ü–û–õ–ù–´–ô –û–¢–ö–ê–¢ –ö –ù–ê–ß–ê–õ–£

```bash
# –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
git reset --hard 17c546d

# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å —Ñ–∞–π–ª—ã
git checkout -- src/services/ClaudeService.js
```

---

## üìà –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–æ—Å–ª–µ —ç—Ç–∞–ø–∞ 1:
- ‚úÖ –ò—Å—á–µ–∑–Ω—É—Ç –æ—à–∏–±–∫–∏ `cache_control: Extra inputs are not permitted`
- ‚úÖ –ë–æ—Ç —Å–Ω–æ–≤–∞ –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –≤ —Å–µ—Å—Å–∏—è—Ö
- ‚úÖ –ë–∞–∑–æ–≤–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ system prompt —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–æ—Å–ª–µ —ç—Ç–∞–ø–∞ 2:
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è 85-90% —Ç–æ–∫–µ–Ω–æ–≤ –≤ –¥–ª–∏–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–∞—Ö
- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ 5-–º–∏–Ω—É—Ç–Ω–æ–≥–æ –∫–µ—à–∞
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ API –≤—ã–∑–æ–≤–æ–≤

---

## üìû –°–¢–ê–¢–£–° –†–ê–ë–û–¢–´

**–ù–ê–ß–ê–õ–û:** 12.06.2025 00:47
**–°–¢–ê–¢–£–°:** üîÑ –í –ü–†–û–¶–ï–°–°–ï...

### –õ–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- [ ] –≠—Ç–∞–ø 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞
- [ ] –≠—Ç–∞–ø 2: –£–º–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ  
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- [ ] –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç

---

**–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è...**